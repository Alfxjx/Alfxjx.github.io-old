<!DOCTYPE html>
<html lang="">
  <head><meta name="generator" content="Hexo 3.8.0">
    
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,minimum-scale=1,maximum-scale=1">


<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">



  <meta name="description" content="理解前端模块化">




  <meta name="keywords" content="FE,">





  <link rel="alternate" href="/default" title="Alfred's">




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=1.1">



<link rel="canonical" href="http://yoursite.com/2019/01/14/前端模块化/">


<meta name="description" content="模块化的目的是使代码可以重用，模块化在任何开发中都是必不可少的。前端的模块化是Node.js带来的新产物，若干年前，前端模块化的需求并不是很强烈，因为在浏览器里运行的逻辑都比较简单。随着Node.js的出现，JavaScript开始在后端发挥作用，为了代码重用，模块化就变得不可或缺。随着前端快速发展，前端业务越来越复杂，模块化的需求开始出现。">
<meta name="keywords" content="FE">
<meta property="og:type" content="article">
<meta property="og:title" content="理解前端模块化">
<meta property="og:url" content="http://yoursite.com/2019/01/14/前端模块化/index.html">
<meta property="og:site_name" content="Alfred&#39;s">
<meta property="og:description" content="模块化的目的是使代码可以重用，模块化在任何开发中都是必不可少的。前端的模块化是Node.js带来的新产物，若干年前，前端模块化的需求并不是很强烈，因为在浏览器里运行的逻辑都比较简单。随着Node.js的出现，JavaScript开始在后端发挥作用，为了代码重用，模块化就变得不可或缺。随着前端快速发展，前端业务越来越复杂，模块化的需求开始出现。">
<meta property="og:locale" content="default">
<meta property="og:updated_time" content="2019-02-20T08:57:43.752Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="理解前端模块化">
<meta name="twitter:description" content="模块化的目的是使代码可以重用，模块化在任何开发中都是必不可少的。前端的模块化是Node.js带来的新产物，若干年前，前端模块化的需求并不是很强烈，因为在浏览器里运行的逻辑都比较简单。随着Node.js的出现，JavaScript开始在后端发挥作用，为了代码重用，模块化就变得不可或缺。随着前端快速发展，前端业务越来越复杂，模块化的需求开始出现。">


<link rel="stylesheet" type="text/css" href="/css/style.css?v=1.1">
<link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet">


  <link rel="stylesheet" type="text/css" href="/lib/fancybox/jquery.fancybox.css">




<script type="text/javascript">
  var themeConfig = {
    fancybox: {
      enable: true
    },
  };
</script>




  



    <title> 理解前端模块化 - Alfred's </title>
  </head>

  <body>
    <div id="page">
      <header id="masthead"><div class="site-header-inner">
    <h1 class="site-title">
        <a href="/." class="logo">Alfred's</a>
    </h1>

    <nav id="nav-top">
        
            <ul id="menu-top" class="nav-top-items">
                
                    <li class="menu-item">
                        <a href="/archives">
                            
                            
                                Archives
                            
                        </a>
                    </li>
                
                    <li class="menu-item">
                        <a href="/about">
                            
                            
                                About
                            
                        </a>
                    </li>
                
            </ul>
        
  </nav>
</div>

      </header>
      <div id="content">
        
    <div id="primary">
        
  <article class="post">
    <header class="post-header">
      <h1 class="post-title">
        
          理解前端模块化
        
      </h1>

      <time class="post-time">
          Jan 14 2019
      </time>
    </header>



    
            <div class="post-content">
            <p>模块化的目的是使代码可以重用，模块化在任何开发中都是必不可少的。前端的模块化是<code>Node.js</code>带来的新产物，若干年前，前端模块化的需求并不是很强烈，因为在浏览器里运行的逻辑都比较简单。随着<code>Node.js</code>的出现，JavaScript开始在后端发挥作用，为了代码重用，模块化就变得不可或缺。随着前端快速发展，前端业务越来越复杂，模块化的需求开始出现。</p>
<a id="more"></a>
<p>为了实现模块化，出现了用于JavaScript模块管理的两大流行规范：CommonJS和AMD。前者定义的是模块的同步加载，主要用于Node.js。同步加载在前端会导致整个页面等待，对前端并不适用，便出现了AMD。AMD采用异步加载方式，通过RequireJS等工具适用于前端。以RequireJS为例，这是一种在线“编译”模块的方案，相当于在浏览器中先加载一个AMD解释器，使浏览器认识define、exports、module等相关命令，来实现模块化。后来ES 6提供了对模块的原生支持，它的目标是创建一种CommonJS和AMD使用者都愿意接受的方式，既拥有简洁的语法，又支持异步加载和配置模块加载。</p>
<p>而目前更通用的是browserify、webpack等技术，是一个预编译模块的方案。这个方案更加智能，因为它是在发布前预编译好的，不需要在浏览器中加载解释器。另外，直接写AMD或ES 6的模块化代码，它都能编译成浏览器识别的JavaScript代码。甚至CommonJS规范的模块化，browserify、webpack也可以转换成浏览器使用的形式。webpack相当于加强版browserify，诞生伊始，瞄准的就是大型单页应用，而且其对React的支持是最好的，所以在本书中主要介绍webpack。</p>
<p>webpack是一个供浏览器环境使用的模块打包工具。webpack将项目中用到的一切静态资源都视为模块，模块之间可以互相依赖，webpack对它们进行统一的管理及打包发布。下面引用webpack官方图片来说明webpack的作用。</p>
<h3 id="优点"><a href="#优点" class="headerlink" title="优点"></a>优点</h3><p>模块化开发，<strong>一个模块就是一个实现特定功能的文件，有了模块我们就可以更方便的使用别人的代码，要用什么功能就加载什么模块。</strong></p>
<p>模块化开发的4点好处：</p>
<p>　　1 避免变量污染，命名冲突</p>
<p>　　2  提高代码复用率</p>
<p>　　3 提高维护性</p>
<p>　　4 依赖关系的管理</p>
<h3 id="函数封装"><a href="#函数封装" class="headerlink" title="函数封装"></a>函数封装</h3><p>我们在讲到函数逻辑的时候提到过，函数一个功能就是实现特定逻辑的一组语句打包，在一个文件里面编写几个相关函数就是最开始的模块了</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">　　function m1()&#123;</span><br><span class="line">　　　　//...</span><br><span class="line">　　&#125;</span><br><span class="line"></span><br><span class="line">　　function m2()&#123;</span><br><span class="line">　　　　//...</span><br><span class="line">　　&#125;</span><br></pre></td></tr></table></figure>
<p>这样做的缺点很明显，污染了全局变量，并且不能保证和其他模块起冲突，模块成员看起来似乎没啥关系</p>
<h3 id="对象"><a href="#对象" class="headerlink" title="对象"></a>对象</h3><p>为了解决这个问题，有了新方法，将所有模块成员封装在一个对象中</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> <span class="built_in">module</span> = <span class="keyword">new</span> <span class="built_in">Object</span>(&#123;</span><br><span class="line"></span><br><span class="line">   _count:<span class="number">0</span>,</span><br><span class="line"></span><br><span class="line">   m1:<span class="function"><span class="keyword">function</span> (<span class="params"></span>)</span>&#123;  <span class="string">``</span><span class="string">`  &#125;,</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">   m2:function ()&#123;   `</span><span class="string">``</span>  &#125;                </span><br><span class="line">  </span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>这样 两个函数就被包在这个对象中， 嘿嘿 看起来没毛病是吗 继续往下：</p>
<p>当我们要使用的时候，就是调用这个对象的属性</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">module.m1()</span><br></pre></td></tr></table></figure>
<p>诶嘿 那么问题来了 这样写法会暴露全部的成员，<strong>内部状态可以被外部改变</strong>，比如外部代码可直接改变计数器的值</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">//坏人的操作</span><br><span class="line"></span><br><span class="line">module._count = 10;</span><br></pre></td></tr></table></figure>
<h3 id="立即执行函数"><a href="#立即执行函数" class="headerlink" title="立即执行函数"></a>立即执行函数</h3><p>最后的最后，聪明的人类找到了究极新的方法——立即执行函数，这样就可以达到不暴露私有成员的目的</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> <span class="built_in">module</span> = (<span class="function"><span class="keyword">function</span> (<span class="params"></span>)</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> _count = <span class="number">5</span>;</span><br><span class="line">     </span><br><span class="line">    <span class="keyword">var</span> m1 = <span class="function"><span class="keyword">function</span> (<span class="params"></span>)</span>&#123;  <span class="string">``</span><span class="string">`   &#125;;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    var m2 = function ()&#123;  `</span><span class="string">``</span>   &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span>&#123;</span><br><span class="line">         m1:m1,</span><br><span class="line">         m2:m2</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;)()</span><br></pre></td></tr></table></figure>
<h3 id="CommonJS"><a href="#CommonJS" class="headerlink" title="CommonJS"></a>CommonJS</h3><p>根据commonJS规范，一个单独的文件是一个模块，每一个模块都是一个单独的作用域，也就是说，在该模块内部定义的变量，无法被其他模块读取，除非为global对象的属性。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> name = <span class="string">'Byron'</span>;  </span><br><span class="line">  </span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">printName</span>(<span class="params"></span>)</span>&#123;  </span><br><span class="line">    <span class="built_in">console</span>.log(name);  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">printFullName</span>(<span class="params">firstName</span>)</span>&#123;  </span><br><span class="line">    <span class="built_in">console</span>.log(firstName + name);  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line"><span class="built_in">module</span>.exports = &#123;  </span><br><span class="line">    printName: printName,  </span><br><span class="line">    printFullName: printFullName</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// load the module</span></span><br><span class="line"><span class="keyword">var</span> nameModule = <span class="built_in">require</span>(<span class="string">'./myModel.js'</span>);</span><br><span class="line">nameModule.printName();</span><br></pre></td></tr></table></figure>
<h3 id="Asynchronous-Module-Definition-一步模块"><a href="#Asynchronous-Module-Definition-一步模块" class="headerlink" title="Asynchronous Module Definition 一步模块"></a>Asynchronous Module Definition 一步模块</h3><p>Asynchronous Module Definition，中文名是一步模块。它是一个在浏览器端模块化开发的规范，由于不是js原生支持，使用AMD规范进行页面开发需要用到对应的函数库，也就是大名鼎鼎的RequireJS，实际上AMD是RequireJS在推广过程中对模块定义的规范化的产出。</p>
<p>requireJS主要解决两个问题：</p>
<p>1 多个js文件可能有依赖关系，被依赖的文件需要早于依赖它的文件加载到浏览器。</p>
<p>2 js加载的时候浏览器会停止页面渲染，加载文件愈多，页面失去响应的时间愈长。</p>
<p><strong>AMD推崇的是依赖前置</strong>，被提前罗列出来并会背提前下载并执行，后来做了改进，可以不用罗列依赖模块，允许在回调函数中就近使用require引入并下载执行模块。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//定义模块</span></span><br><span class="line"></span><br><span class="line">define([<span class="string">'dependency'</span>],<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">var</span> name = <span class="string">'Byron'</span>;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">printName</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">     <span class="built_in">console</span>.log(name);</span><br><span class="line">&#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">     printName:printName</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">//加载模块</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">require</span>([<span class="string">'myModule'</span>],<span class="function"><span class="keyword">function</span>(<span class="params">my</span>)</span>&#123;</span><br><span class="line">   my.printName();</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h3 id="Common-Module-Definition"><a href="#Common-Module-Definition" class="headerlink" title="Common Module Definition"></a>Common Module Definition</h3><p>cmd是sea.js在推广过程中的规范化产出，sea.js是另一种前端模块化工具，它的出现缓解了requireJS的几个痛点。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">define(id, deps, factory)</span><br><span class="line"></span><br><span class="line">因为CMD推崇一个文件一个模块，所以经常就用文件名作为模块id；</span><br><span class="line">CMD推崇依赖就近，所以一般不在define的参数中写依赖，而是在factory中写。</span><br><span class="line"></span><br><span class="line">factory有三个参数：</span><br><span class="line"><span class="function"><span class="keyword">function</span>(<span class="params">require, exports, module</span>)</span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">一，<span class="built_in">require</span></span><br><span class="line"><span class="built_in">require</span> 是 factory 函数的第一个参数，<span class="built_in">require</span> 是一个方法，接受 模块标识 作为唯一参数，用来获取其他模块提供的接口；</span><br><span class="line"></span><br><span class="line">二，exports</span><br><span class="line">exports 是一个对象，用来向外提供模块接口；</span><br><span class="line"></span><br><span class="line">三，<span class="built_in">module</span></span><br><span class="line"><span class="built_in">module</span> 是一个对象，上面存储了与当前模块相关联的一些属性和方法。</span><br><span class="line"></span><br><span class="line">demo</span><br><span class="line"><span class="comment">// 定义模块  myModule.js</span></span><br><span class="line">define(<span class="function"><span class="keyword">function</span>(<span class="params">require, exports, module</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> $ = <span class="built_in">require</span>(<span class="string">'jquery.js'</span>)</span><br><span class="line">  $(<span class="string">'div'</span>).addClass(<span class="string">'active'</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 加载模块</span></span><br><span class="line">seajs.use([<span class="string">'myModule.js'</span>], <span class="function"><span class="keyword">function</span>(<span class="params">my</span>)</span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>AMD推崇依赖前置 在定义模块的时候就有声明其依赖的模块</p>
<p>CMD推崇就近依赖 只有在用到某模块的时候再去require</p>

            </div>
          

    
      <footer class="post-footer">
		
		<div class="post-tags">
		  
			<a href="/tags/FE/">FE</a>
		  
		</div>
		

        
        
  <nav class="post-nav">
    
      <a class="prev" href="/2019/01/15/Call-Apply-Bind/">
        <i class="iconfont icon-left"></i>
        <span class="prev-text nav-default">Call-Apply-Bind的区别</span>
        <span class="prev-text nav-mobile">Prev</span>
      </a>
    
    
      <a class="next" href="/2019/01/12/常见WEB攻击手段与预防措施/">
        <span class="next-text nav-default">常见WEB攻击手段与预防措施</span>
        <span class="prev-text nav-mobile">Next</span>
        <i class="iconfont icon-right"></i>
      </a>
    
  </nav>

        
  <div class="comments" id="comments">
    
  </div>


      </footer>
    
  </article>

    </div>

      </div>

      <footer id="colophon"><span class="copyright-year">
    
        &copy;
    
        2018 -
    
    2019
    <span class="footer-author">Xu Jianxiang.</span>
    <span class="power-by">
        Powered by <a class="hexo-link" href="https://hexo.io/">Hexo</a> and <a class="theme-link" href="https://github.com/frostfan/hexo-theme-polarbear">Polar Bear</a>
    </span>
</span>

      </footer>

      <div class="back-to-top" id="back-to-top">
        <i class="iconfont icon-up"></i>
      </div>
    </div>
    


    
  





  
    <script type="text/javascript" src="/lib/jquery/jquery-3.1.1.min.js"></script>
  

  
    <script type="text/javascript" src="/lib/fancybox/jquery.fancybox.pack.js"></script>
  

    <script type="text/javascript" src="/js/src/theme.js?v=1.1"></script>
<script type="text/javascript" src="/js/src/bootstrap.js?v=1.1"></script>

  </body>
</html>
